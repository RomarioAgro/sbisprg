
функция РазбитьСтроки(ИсходСтрока, ТребДлинаСтроки, КолСтрок)
{ i=1;  j1=1;  ФормСтрока=1;
  ИсходСтрока += " ";
  Очистить(СформСтрока);
  ДлинаСтроки = Размер(ИсходСтрока);  
  Если (ДлинаСтроки > ТребДлинаСтроки)
  { Пока((ФормСтрока <= КолСтрок) и (j1 < ДлинаСтроки))
    { ф1=ПодСтрока(ИсходСтрока,j1,ТребДлинаСтроки);
      Если((ПодСтрока(ф1,ТребДлинаСтроки,1) != " ") и (ПодСтрока(ф1,ТребДлинаСтроки,1) != ","))
      { #сообщить(ТребДлинаСтроки-i);
        Пока((ПодСтрока(ф1,ТребДлинаСтроки-i,1) != " ") и (ПодСтрока(ф1,ТребДлинаСтроки-i,1) != ","))
        { 
          i++;
          Если((ТребДлинаСтроки-i)==0)
          {   #    Сообщить ("Нет пробелов в строке");
            
            Прервать();
          }
        }
        ф1=ПодСтрока(ИсходСтрока,j1,ТребДлинаСтроки-i);
      }
      иначе 
        ф1=ПодСтрока(ИсходСтрока,j1,ТребДлинаСтроки);
       если(Подстрока(ф1,Размер(ф1),1)==" ") ф1 = Подстрока(ф1,1,Размер(ф1)-1);
       если(Подстрока(ф1,1,1)==",") ф1 = Подстрока(ф1,2,Размер(ф1)-1);
       .СформСтрока[ФормСтрока]=ф1;
       ФормСтрока+=1; j1+=ТребДлинаСтроки-i; i=1;
    }
  }
  иначе .СформСтрока[ФормСтрока]=ПодСтрока(ИсходСтрока,j1,ТребДлинаСтроки);
}
