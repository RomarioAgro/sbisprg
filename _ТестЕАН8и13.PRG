Функция _ТестЕАН8и13(ШКод)
{
  пРез=0;
  инд=1;
  Пока(инд<=Размер(ШКод))
  {
#     Сообщить(инд+"\n"+ПодСтрока(ШКод,инд,1));
     Если(Найти("0123456789",ПодСтрока(ШКод,инд,1)))
        инд++;
     Иначе
        Вернуть 0;

  }
  Если(Размер(ШКод)==8 ИЛИ Размер(ШКод)==13)
  {
    Если(Размер(ШКод)==13)
    {
       пЧР=(Число(ПодСтрока(ШКод,2,1))+Число(ПодСтрока(ШКод,4,1))+
            Число(ПодСтрока(ШКод,6,1))+Число(ПодСтрока(ШКод,8,1))+
            Число(ПодСтрока(ШКод,10,1))+Число(ПодСтрока(ШКод,12,1)));
       пНР=(Число(ПодСтрока(ШКод,1,1))+Число(ПодСтрока(ШКод,3,1))+
            Число(ПодСтрока(ШКод,5,1))+Число(ПодСтрока(ШКод,7,1))+
            Число(ПодСтрока(ШКод,9,1))+Число(ПодСтрока(ШКод,11,1)));
       пСР=пЧР*3+пНР;
       пСМ=пСР;
       Если(!Найти("567890",ПодСтрока(пСР,Размер(пСР),1)))
         пСМ=пСМ+5;
       пСМ=Окр(пСМ,10);
       пКР=пСМ-пСР;
       Если(Число(ПодСтрока(ШКод,13))==пКР)
         пРез=1;
    }
    Если(Размер(ШКод)==8)
    {
       пЧР=(Число(ПодСтрока(ШКод,1,1))+Число(ПодСтрока(ШКод,3,1))+
            Число(ПодСтрока(ШКод,5,1))+Число(ПодСтрока(ШКод,7,1)));
       пНР=(Число(ПодСтрока(ШКод,2,1))+Число(ПодСтрока(ШКод,4,1))+
            Число(ПодСтрока(ШКод,6,1)));
       пСР=пЧР*3+пНР;
       пСМ=пСР;
       Если(!Найти("567890",ПодСтрока(пСР,Размер(пСР),1)))
         пСМ=пСМ+5;
       пСМ=Окр(пСМ,10);
       пКР=пСМ-пСР;
       Если(Число(ПодСтрока(ШКод,8))==пКР)
         пРез=1;
    }
  }
    Иначе Если(!Размер(ШКод)) пРез=-1;
  Если(Размер(ШКод)==7 И ПодСтрока(ШКод,1,1)=="2") пРез=2;
  Вернуть пРез;
}
