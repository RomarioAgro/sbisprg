Функция _АкцияРаспродажаНаНовуюКоллекцию()
{
#Акция с 22.09 по 02.10 при покупке 3 и более товаров по распродаже, 
#массив то что нужно включить в акцию(эти товары исключаются словами и категориями, а по этому массиву строго определяется, что этот товар участвует в акции)
пСтрока.1=""
пСтрока.2=""
пСтрока.3=""
пСтрока.4=""
пСтрока.5=""
пСтрока.6=""
пСтрока.7=""
пСтрока.8=""
пСтрока.9=""
пСтрока.10=""
пСтрока.11=""
пСтрока.12=""
пСтрока.13=""
пСтрока.14=""
пСтрока.15=""
пСтрока.16=""
пСтрока.17=""
пСтрока.18=""
пСтрока.19=""
пСтрока.20=""
пСтрока.21=""
пСтрока.22=""
пСтрока.23=""
пСтрока.24=""
пСтрока.25=""
пСтрока.26=""

пКолСтрокАкции=27

#масиив, который нужно исключить из акции
пСтрокаИскл.1=";2384;5294;5682;5795;5870;7226;10060;11342;11380;11408;11410;11413;11431;11432;11435;11483;11944;12278;13121;13127;13414;13435;13550;13763;13793;14819;14820;14872;15264;15462;17382;17929;18106;18596;18618;"
пСтрокаИскл.2=";18619;18620;18621;18662;18663;18791;18793;19102;19727;20163;20239;21432;21617;21677;21685;21890;22050;22357;22358;22366;22460;22461;22462;22465;22587;22779;23442;23444;23484;23724;24886;24888;24899;24900;"
пСтрокаИскл.3=";24901;25213;25873;27058;27075;27353;27355;28031;28302;28852;28887;28890;29205;30495;31424;31425;31426;32489;32491;32492;32812;33037;33953;34109;34418;34419;34741;34939;35294;35662;36101;36148;36149;36919;"
пСтрокаИскл.4=";36923;36927;39353;39675;40840;41490;41492;41904;42724;44301;44302;44308;44310;44516;45468;45472;46328;47097;47099;47121;47123;48429;48431;48459;48851;49930;50167;50169;50171;50175;50177;50906;50908;52868;"
пСтрокаИскл.5=";53515;53517;53592;53594;54760;54761;54763;55573;55703;55707;55953;55959;55963;56536;56538;56542;56768;57048;57050;58286;59138;60273;60395;60397;60406;60534;61603;61614;61794;63828;63897;65252;65253;65375;"
пСтрокаИскл.6=";65788;66272;66292;66626;67010;67029;67054;67058;68724;69296;69560;69738;69741;69744;69748;69751;70135;70305;71188;71282;71946;71947;71966;71967;73550;73551;74032;74159;74864;75993;75999;76000;76003;76006;"
пСтрокаИскл.7=";76016;76019;76022;76029;76032;76041;76044;78508;78824;79405;79655;80015;80018;80021;80022;80061;80064;80067;80073;80076;80626;80635;80767;80854;80855;81112;81113;81130;81131;81132;81133;81153;81154;81870;"
пСтрокаИскл.8=";81876;81877;81880;81881;81953;81993;82011;82012;82061;82062;82704;84254;84255;85361;85398;86683;86684;86685;86686;86687;86688;86689;86690;86691;86692;86693;86694;86695;86696;86697;86698;86699;86700;86701;"
пСтрокаИскл.9=";86702;86703;86704;86706;86707;86788;86796;86798;86802;87702;87822;88556;88557;88593;88596;88621;88647;88649;88962;89803;90077;91643;91835;91850;92047;92334;92335;92336;92718;93197;93255;93367;93569;94487;"
пСтрокаИскл.10=";94638;94639;94640;94641;94642;94643;94644;94645;94646;94647;94648;94649;94650;94651;94652;94653;94654;94655;94656;94871;94872;94873;94874;94875;94883;94991;94992;94993;94994;94995;94996;95074;96193;96296;"
пСтрокаИскл.11=";96755;97116;97124;97815;97984;98072;98121;98145;98153;98155;98157;98163;98168;98170;98248;98683;98947;98948;98949;99003;99016;99017;99018;99019;99397;99398;99405;99571;99581;99924;99930;99966;99967;99968;"
пСтрокаИскл.12=";99969;99983;100041;100288;100490;100491;100493;100494;100495;100496;100497;100498;100499;100500;100501;100502;100510;100511;100512;100513;100514;100515;100516;100517;100518;100519;100520;100521;100522;"
пСтрокаИскл.13=";100523;100539;100540;100541;100542;100569;100570;100571;100572;100579;100580;100581;100582;100693;100778;101665;101669;101742;102563;102566;102569;102572;102624;103440;104375;104381;105691;105930;107587;"
пСтрокаИскл.14=";107659;107801;107873;108114;108115;108150;108152;108364;108759;109051;109181;109789;110091;110097;110822;110825;112323;112358;112881;112887;112890;112941;112988;112989;112990;113026;113097;113952;114241;"
пСтрокаИскл.15=";114244;114697;114713;114978;115274;115500;115832;115833;115834;115835;115836;115837;115838;115839;115841;115842;115844;115846;115847;115849;115850;115851;115852;115853;115854;115855;115874;115875;115876;"
пСтрокаИскл.16=";115877;115878;116096;116773;116928;117019;117144;117217;117351;117473;117475;117476;117477;117478;117600;117601;117602;117603;117604;117605;117606;117607;117608;117609;117664;117983;117984;117990;117996;"
пСтрокаИскл.17=";118142;118297;118338;119298;119678;119679;119688;119881;119992;120092;120112;120386;120387;120388;120389;120390;120452;120453;120454;120455;120494;120757;120983;121362;121621;121781;121782;121816;121817;"
пСтрокаИскл.18=";121818;121819;121881;121883;121884;121886;121888;121889;121890;121893;121894;121895;121896;121897;121898;121899;121900;121901;121902;121903;121904;121905;121915;121916;121917;121918;121919;121920;121921;"
пСтрокаИскл.19=";121922;121923;121924;121925;121926;121927;121928;121929;121930;121931;121932;121933;121934;121935;121936;121937;121938;121939;121940;121941;121942;121943;121944;121945;121946;121947;122211;122563;122589;"
пСтрокаИскл.20=";122670;122679;123105;123513;123888;123890;124105;124367;124501;124553;124612;124682;124683;124893;125002;125531;125655;125663;125922;125923;125924;125925;125926;125927;125928;125929;125930;125931;126176;"
пСтрокаИскл.21=";126184;126346;126578;126602;126603;126604;126606;127009;127250;127286;128123;128124;128126;128363;128609;128658;128659;128660;128661;128662;128720;128721;128722;128723;128724;129008;129541;129892;129895;"
пСтрокаИскл.22=";129896;130706;130708;131577;131659;131717;132509;132510;132511;132512;132531;132532;132533;132534;132535;132536;132537;132538;132539;132540;132541;132542;132543;132544;132545;132546;132547;132548;132549;"
пСтрокаИскл.23=";132550;132551;132552;132553;132554;132555;132589;132590;132591;132592;132593;132594;132595;132596;132597;132598;132599;132600;132601;132602;132603;132604;132605;132606;132607;132623;132650;133053;133054;"
пСтрокаИскл.24=";133324;133326;133327;133328;133330;133625;133626;133711;133831;133832;133833;133835;133965;134031;134196;134233;134234;134236;134237;134240;134391;134482;134486;134500;134547;134573;134574;134642;134753;"
пСтрокаИскл.25=";134899;134900;134902;134904;134955;134990;134991;134992;134993;134994;134995;134996;134997;134998;134999;135285;135286;135287;135288;135292;135293;135298;135299;135348;136023;136150;136205;136256;136957;"
пСтрокаИскл.26=";138719;138720;138721;138722;138723;138724;138725;138726;138727;138728;138729;138730;138731;138732;138733;138734;138735;138736;138737;138738;138741;138742;138743;138744;138807;139053;139113;139116;139119;"
пСтрокаИскл.27=";139487;139510;139527;139529;139530;139531;139532;139533;139685;139694;140208;140773;140779;140780;140797;140798;140799;140800;140804;140805;140806;140807;140826;140827;140828;140839;140841;140842;140849;"
пСтрокаИскл.28=";140850;140855;140857;140863;140865;140887;140889;140897;140899;140901;140902;140904;140905;140929;140932;140933;141031;141545;141550;141635;141636;141637;142659;142663;142665;142667;142668;142669;142670;"
пСтрокаИскл.29=";142672;142676;142677;142684;142685;143044;143045;143531;143532;143533;143534;143535;143536;143537;143538;143539;143540;143541;143542;143543;143544;143545;143546;143547;143548;143549;143550;143821;143863;"
пСтрокаИскл.30=";144018;144028;144054;144059;189196;189197;189445;189918;189964;189974;189987;190683;190712;190742;190875;190962;191096;191132;191133;191134;191136;191137;191226;191230;191258;191261;191262;191263;192985;"
пСтрокаИскл.31=";193023;193053;193130;193136;193167;193175;193412;193416;193624;193700;194199;194268;194269;194270;194271;194272;194273;194336;194516;194526;194535;194536;194570;194593;194922;194923;195567;195568;195596;"
пСтрокаИскл.32=";195611;195889;195890;196101;196901;196902;196906;196907;196908;196909;196910;196911;196915;196922;196923;196924;196925;196970;196971;196972;196973;197006;197007;197009;197392;197744;197745;197746;197747;"
пСтрокаИскл.33=";197748;197749;197750;197751;197752;197753;197827;197829;197830;197831;197832;197948;197950;197955;197956;197957;197958;197959;197960;197961;197963;197964;198011;198013;198166;198207;198211;198212;198215;"
пСтрокаИскл.34=";198216;198485;198926;198927;198929;198930;198931;198932;198933;198938;199323;"
пКолСтрокАкцииИскл=35;

        #оставим пустую строку, мало ли надо будет добавить что-нить в акцию

пСтрокаКат=";75;67;69;128;96;119;105;136;60;91;82;83;84;85;126;132;86;135;87;112;109;122;108;88;89;90;80;71;66;76;68;64;77;130;131;72;78;79;114;127;129;125;73;74;70;95;"
пКолАкции=0;
пСлово=0;
пСтрокаАкции="";
ДляВСех(Наименований())
{
пСлово=0;
#если товар совпадает со словом, присваеваем пСлово=1
   Если (Найти(Вверх('Наим.Наименование'),"ТРУСЫ")!=0
   или Найти(Вверх('Наим.Наименование')," ТР.")!=0
   или Найти(Вверх('Наим.Наименование'),"СТРИНГ")!=0
   или Найти(Вверх('Наим.Наименование'),"БОКСЕР")!=0
   или Найти(Вверх('Наим.Наименование'),"ПЛАВКИ")!=0
   или Найти(Вверх('Наим.Наименование'),"КУПАЛ")!=0
   или Найти(Вверх('Наим.Наименование'),"БИКИН")!=0
   или Найти(Вверх('Наим.Наименование'),"ТАНГА")!=0
   или Найти(Вверх('Наим.Наименование'),"ГАЛСТ")!=0
   или Найти(Вверх('Наим.Наименование'),"KOR ")!=0

#   или Найти(Вверх('Наим.Наименование'),"МАЙКА")!=0
#   или Найти(Вверх('Наим.Наименование'),"YAX ")!=0
#   или Найти(Вверх('Наим.Наименование'),"VI ")!=0
#   или Найти(Вверх('Наим.Наименование'),"У ")!=0
#   или Найти(Вверх('Наим.Наименование'),"DN ")!=0
#   или Найти(Вверх('Наим.Наименование'),"БОКСЕР")!=0
#   или Найти(Вверх('Наим.Наименование'),"СТРИНГ")!=0
#   или Найти(Вверх('Наим.Наименование'),"СТРИНГИ")!=0
#   или Найти(Вверх('Наим.Наименование'),"ШОРТЫ")!=0
#   или Найти(Вверх('Наим.Наименование'),"БИКИНИ")!=0
#   или Найти(Вверх('Наим.Наименование'),"ТАНГА")!=0
#   или Найти(Вверх('Наим.Наименование'),"ТОП")!=0
#   или Найти(Вверх('Наим.Наименование'),"НАБОР БИКИНИ")!=0
#   или Найти(Вверх('Наим.Наименование'),"НАБОР СТРИНГИ")!=0
#   или Найти(Вверх('Наим.Наименование'),"БРАЗИЛИАНО")!=0
#   или Найти(Вверх('Наим.Наименование'),"СЛИП")!=0
#   или Найти(Вверх('Наим.Наименование'),"БОКСЕР")!=0
#   или Найти(Вверх('Наим.Наименование'),"ТРУСЫ")!=0
#   или Найти(Вверх('Наим.Наименование'),"НОСКИ")!=0
#   или Найти(Вверх('Наим.Наименование'),"Носки")!=0
#   или Найти(Вверх('Наим.Наименование'),"НОС.")!=0
#   или Найти(Вверх('Наим.Наименование'),"Очки")!=0
#   или Найти(Вверх('Наим.Наименование'),"КОЛГОТКИ")!=0
#   или Найти(Вверх('Наим.Наименование'),"КОЛГ")!=0
#   или Найти(Вверх('Наим.Наименование'),"ПЕРЧАТКИ")!=0
#   или Найти(Вверх('Наим.Наименование')," ТР.")!=0
#   или Найти(Вверх('Наим.Наименование'),"ПЕРЧАТКИ")!=0
#   или Найти(Вверх('Наим.Наименование'),"КУПАЛ")!=0
#   или Найти(Вверх('Наим.Наименование'),"Pel BUA")!=0
#   или Найти(Вверх('Наим.Наименование'),"Pel GUA")!=0
#   или Найти(Вверх('Наим.Наименование'),"ПЛАВКИ")!=0
)
      {
        Если (Найти(Вверх('Наим.Наименование'),"ЭЙС МАЙКАF")==0 
и Найти(Вверх('Наим.Наименование'),"CLE МАЙКАF")==0 ) пСлово=1;
      }
пСч=1;
пСч2=1;
пКодАрт=";"+'Наим.Иерархия.НомНомер'+";";
пКатегория=";"+'Наим.ИЕРАРХИЯ.Иерархия.НомНомер'+";";

Если(Найти(пСтрокаКат,пКатегория)!=0) пСлово=1;
Если(Наим.Цена2!=0) пСлово=1;
Если(пСлово!=1)
{ 
Пока(пСч<пКолСтрокАкцииИскл)
   {
            Если(Найти(пСтрокаИскл[пСч], пКодАрт)!=0)
              {#товар, который не участвует в акции
               пСч=1000;#типа выход из цикла               
               пСлово=1;
               }
            пСч++;
    }
}
Если(пСлово!=0)
{ 
Пока(пСч2<пКолСтрокАкции)
   {
            Если(Найти(пСтрока[пСч2], пКодАрт)!=0)
                  {#товар который должен участвовать в акции
                     пСч2=1000;#типа выход из цикла               
                     пСлово=0;
                  }
            пСч2++;
   }
}

#Ище товар в нашем списке, если он находится или было совпадение по слову тогда сохраняем товар и прибавляем количество
Если(Наим.СуммаЦен>0  и пСлово==0)
   {
      пСтрокаАкции+=";"+'Наим.НомНомер';
      пКолАкции+=Наим.Кол_во;
   }
}

ДляВСех(Наименований())
{
Если(Наим.СуммаЦен>0 и пКолАкции==2)
{
Если(Найти(пСтрокаАкции,'Наим.НомНомер')!=0)
   {
   Наим.СуммаЦен=Окр(Наим.Кол_во*Наим.Цена3*0.9,1);
   '.Примечание'="Акция распродажа=-10%";
   'НАИМ.Комментарий'="Акция -10%"; 
  Сохранить(Наим);
   }
}
Если(Наим.СуммаЦен>0 и пКолАкции==3)
{
Если(Найти(пСтрокаАкции,'Наим.НомНомер')!=0)
   {
   Наим.СуммаЦен=Окр(Наим.Кол_во*Наим.Цена3*0.85,1);
   '.Примечание'="Акция распродажа=-15%";
   'НАИМ.Комментарий'="Акция -15%"; 
  Сохранить(Наим);
   }
}

Если(Наим.СуммаЦен>0 и пКолАкции>=4)
{
Если(Найти(пСтрокаАкции,'Наим.НомНомер')!=0)
   {
   Наим.СуммаЦен=Окр(Наим.Кол_во*Наим.Цена3*0.8,1);
   '.Примечание'="Акция распродажа=-20%";
   'НАИМ.Комментарий'="Акция -20%"; 
  Сохранить(Наим);
   }
}
}
}