Функция _КодКС_ЕАН13(ШКод)
{
  пКР=0;
  Если(Размер(ШКод)==12)
  {
     пЧР=(Число(ПодСтрока(ШКод,2,1))+Число(ПодСтрока(ШКод,4,1))+
          Число(ПодСтрока(ШКод,6,1))+Число(ПодСтрока(ШКод,8,1))+
          Число(ПодСтрока(ШКод,10,1))+Число(ПодСтрока(ШКод,12,1)));
     пНР=(Число(ПодСтрока(ШКод,1,1))+Число(ПодСтрока(ШКод,3,1))+
          Число(ПодСтрока(ШКод,5,1))+Число(ПодСтрока(ШКод,7,1))+
          Число(ПодСтрока(ШКод,9,1))+Число(ПодСтрока(ШКод,11,1)));
     пСР=пЧР*3+пНР;
     пСМ=пСР;
     Если(!Найти("567890",ПодСтрока(пСР,Размер(пСР),1)))
       пСМ=пСМ+5;
     пСМ=Окр(пСМ,10);
     пКР=пСМ-пСР;
#     Сообщить(пКР);
  }
  Вернуть пКР;
}
